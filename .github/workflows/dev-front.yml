name: Deploy frontend to EC2

on:
  push:
    branches:
      - dev



jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install dependencies
      run: cd frontEnd && npm install

    - name: Build frontend
      run: cd frontEnd && npm run build

    - name: Deploy to EC2
      uses: appleboy/scp-action@master
      with:
        host: ${{ secrets.EC2_IP }}
        username: ubuntu
        key: ${{ secrets.EC2_PASSWORD }}
        source: "./frontEnd/dist"
        target: "/home/ubuntu/"
        
    - name: Transfer Deploy Script use SCP
      uses: appleboy/scp-action@master
      with:
        username: ubuntu
        host: ${{ secrets.HOST }}
        key: ${{ secrets.PRIVATE_KEY }}
        source: "deploy.sh"
        target: "/home/ubuntu/frontEnd"
        
        

